<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; The Multi-Mission Maximum Likelihood framework  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/general.css" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/dark.css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../_static/dark_mode_js/default_dark.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Intro" href="../intro.html" />
    <link rel="prev" title="3ML" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            The Multi-Mission Maximum Likelihood framework
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#XSPEC-models">XSPEC models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HEASARC-install">HEASARC install</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xspec-modelsonly">xspec-modelsonly</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Conda-installation">Conda installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#If-you-don't-know-Conda">If you don’t know Conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#If-you-already-know-Conda">If you already know Conda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pip">pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Other-dependencies">Other dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Install-from-source-(advanced)">Install from source (advanced)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Tips-for-Mac-users">Tips for Mac users</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging and Verbosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xspec_users.html">Notes for XSPEC Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="Minimization_tutorial.html">Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bayesian_tutorial.html">Bayesian Posterior Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler_docs.html">Bayesian Sampler Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html#threeml">threeML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features and examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Analysis_results_showcase.html">Analysis Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_variates.html">Random Variates</a></li>
<li class="toctree-l1"><a class="reference internal" href="Point_source_plotting.html">Point source plotting basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Building_Plugins_from_TimeSeries.html">Constructing plugins from TimeSeries</a></li>
<li class="toctree-l1"><a class="reference internal" href="grb080916C.html">Analyzing GRB 080916C</a></li>
<li class="toctree-l1"><a class="reference internal" href="APEC_doc.html">Fitting XMM-Newton data with the APEC model</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_BAT_gbm_demo.html">Example joint fit between GBM and Swift BAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_fitting_xrt_and_gbm_xspec_models.html">Joint fitting XRT and GBM data with XSPEC models</a></li>
<li class="toctree-l1"><a class="reference internal" href="flux_examples.html">Point Source Fluxes and Multiple Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fermipy_LAT.html">Fermi-LAT via FermiPyLike</a></li>
<li class="toctree-l1"><a class="reference internal" href="LAT_Transient_Builder_Example.html">Analysis of GRB 190114C with Fermi-LAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="Time-energy-fit.html">Time-energy fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="synthetic_spectra.html">Generating Synthetic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="gof_lrt.html">Goodness of Fit and Model Comparison</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Multi-Mission Maximum Likelihood framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Installation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Installation">
<h1>Installation<a class="headerlink" href="#Installation" title="Permalink to this heading"></a></h1>
<p>3ML brings together multiple instrument and fitting software packages into a common framework. Thus, installing all the pieces can be a bit of a task for the user. In order to make this a less painless process, we have packaged most of the external dependencies into conda (see below). However, if you want more control over your install, 3ML is available on PyPI via pip. If you have issues with the installs, first check that you have properly installed all the external dependencies that <em>you</em>
plan on using. Are their libraries accessible on you system’s standard paths? If you think that you have everything setup properly and the install does not work for you, please <a class="reference external" href="https://github.com/threeML/threeML/issues">submit an issue</a> and we will do our best to find a solution.</p>
<section id="XSPEC-models">
<h2>XSPEC models<a class="headerlink" href="#XSPEC-models" title="Permalink to this heading"></a></h2>
<p>We allow the ability to use the models provided by <a href="#id1"><span class="problematic" id="id2">`XSPEC &lt;&gt;`__</span></a> natively in 3ML. However, before installing <a href="#id1"><span class="problematic" id="id3">`astromodels &lt;&gt;`__</span></a> or 3ML, you must already have XSPEC installed by one of a few methods.</p>
<section id="HEASARC-install">
<h3>HEASARC install<a class="headerlink" href="#HEASARC-install" title="Permalink to this heading"></a></h3>
<p>If you have XSPEC installed on your computer via the source code, then before installing astromodels, make sure to <code class="docutils literal notranslate"><span class="pre">init</span></code> your HEASARC environment. Upon installing <code class="docutils literal notranslate"><span class="pre">astromodels</span></code>, the process will attempt to find the proper libraries on your system if it detects XSPEC and compile the proper extensions. If you have installed your XSPEC in a non-standard directory (e.g. your home directory), the process my not find all the libraries. You can thus export an env variable that provides the
explicit path to your XSPEC headers:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">XSPEC_INC_PATH</span><span class="o">=</span>/path/to/xspec/headers
</pre></div>
</div>
<p>As XSPEC evolves, various models have different interfaces that depend on the version. To accommodate this, you need to set the version of XSPEC you are using with another env variable, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">ASTRO_XSPEC_VERSION</span><span class="o">=</span><span class="s1">&#39;12.12.1&#39;</span>
</pre></div>
</div>
</section>
<section id="xspec-modelsonly">
<h3>xspec-modelsonly<a class="headerlink" href="#xspec-modelsonly" title="Permalink to this heading"></a></h3>
<p>I{f using conda, it is possible to get access to XSPEC models without having to install HEASOFT. We thus recommend the following command to create your new conda environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>threeml<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>-c<span class="w"> </span>xspecmodels<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9<span class="w"> </span>xspec-modelsonly<span class="w"> </span>numpy<span class="w"> </span>scipy<span class="w"> </span>matplotlib
</pre></div>
</div>
<p>This must be done <em>before</em> installing <code class="docutils literal notranslate"><span class="pre">astromodels</span></code>.</p>
</section>
</section>
<section id="Conda-installation">
<h2>Conda installation<a class="headerlink" href="#Conda-installation" title="Permalink to this heading"></a></h2>
<p><a class="reference external" href="https://conda.io/docs/">Conda</a> is a platform independent package manager. It allows to install 3ML (and a lot of other software) without the need to compile anything, and in a completely separate environment from your system and your system python.</p>
<section id="If-you-don't-know-Conda">
<h3>If you don’t know Conda<a class="headerlink" href="#If-you-don't-know-Conda" title="Permalink to this heading"></a></h3>
<p>If you are not familiar with conda, install 3ML with the automatic script which will take care of everything:</p>
<ol class="arabic simple">
<li><p>Download the script from <a class="reference external" href="https://raw.githubusercontent.com/threeML/threeML/master/install_3ML.sh">here</a></p></li>
<li><p>Run the script with <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">install_3ML.sh</span></code>. If you plan to use XSPEC models use <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">install_3ML.sh</span> <span class="pre">--with-xspec</span></code>.</p></li>
<li><p>The script will install 3ML and then create a <code class="docutils literal notranslate"><span class="pre">threeML_init.sh</span></code> script and a <code class="docutils literal notranslate"><span class="pre">threeML_init.csh</span></code> script. Source the former if you are using Bash (<code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">threeML_init.sh</span></code>) and the second one if you are using Csh/Tcsh (<code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">threeML_init.csh</span></code>).</p></li>
</ol>
</section>
<section id="If-you-already-know-Conda">
<h3>If you already know Conda<a class="headerlink" href="#If-you-already-know-Conda" title="Permalink to this heading"></a></h3>
<p>If you are familiar with Conda and you already have it installed, you can install 3ML by creating an environment with (<em>note the exceptions above w.r.t. to include XSPEC support</em>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>threeML<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9<span class="w"> </span>numpy<span class="w"> </span>scipy<span class="w"> </span>matplotlib
</pre></div>
</div>
<p>then activating your environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>threeML
</pre></div>
</div>
<p><em>NOTE:</em> Recently a third party has uploaded a version of <code class="docutils literal notranslate"><span class="pre">astromodels</span></code> to the conda-forge channel. This version will break support for XSPEC currently if you used the xspec-modelsonly package. It is important to set your conda channel priority so that the threeml channel has priority over the conda-forge channel. Please verify that the <code class="docutils literal notranslate"><span class="pre">astromodels</span></code> installed comes from our threeml channel. We are working to resolve this hassle and we apologize to our users.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>-c<span class="w"> </span>threeml<span class="w"> </span>astromodels<span class="w"> </span>threeml
</pre></div>
</div>
</section>
</section>
<section id="pip">
<h2>pip<a class="headerlink" href="#pip" title="Permalink to this heading"></a></h2>
<p>If you would like to install 3ML and astromodels on their own and have more control over which dependencies you would like to use. Please to the following</p>
<ol class="arabic simple">
<li><p>It is highly recommended you work within a python virtual environment to keep you base python clean</p></li>
<li><p>install astromodels</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>astromodels
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>install 3ML</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>threeml
</pre></div>
</div>
<p>If you need to build other dependencies such as pagmo, multinest, XSPEC, etc., it is recommended you do this <strong>before</strong> installing astromodels!</p>
</section>
<section id="Docker">
<h2>Docker<a class="headerlink" href="#Docker" title="Permalink to this heading"></a></h2>
<p>A docker with the complete 3ML environment and all dependencies can be installed with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>pull<span class="w"> </span>threeml/notebook:latest
</pre></div>
</div>
<p>which will install a docker that can be launched with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>-v<span class="w"> </span><span class="nv">$PWD</span>:/workdir<span class="w"> </span>-w<span class="w"> </span>/workdir<span class="w"> </span>threeml/notebook
</pre></div>
</div>
<p>which will launch a notebook server that can operate on the current directory. The notebooks and be accessed by typing <code class="docutils literal notranslate"><span class="pre">localhost:8888</span></code> in your browser.</p>
</section>
<section id="Other-dependencies">
<h2>Other dependencies<a class="headerlink" href="#Other-dependencies" title="Permalink to this heading"></a></h2>
<p>You need to set up packages such as AERIE (for HAWC), or the Fermi Science Tools, before running the script, otherwise some of the functionalities will not work.</p>
<ul>
<li><p>AERIE for HAWC: make sure that this works before running the script:</p>
<p>```bash &gt; liff-PointSourceExpectation –version INFO [CommandLineConfigurator.cc, ParseCommandLine:137]:</p>
<p>liff-PointSourceExpectation Aerie version: 2.04.00 Build type: Debug</p>
<p>``` If it doesn’t, you need to set up the HAWC environment (refer to the appropriate documentation)</p>
</li>
<li><p>Fermi Science Tools for Fermi/LAT analysis: make sure that this works: <code class="docutils literal notranslate"><span class="pre">bash</span>&#160;&#160;&#160;&#160; <span class="pre">&gt;</span> <span class="pre">gtirfs</span> <span class="pre">...</span>&#160; <span class="pre">P8R2_TRANSIENT100_V6::EDISP0</span> <span class="pre">P8R2_TRANSIENT100_V6::EDISP1</span> <span class="pre">...</span></code> If it doesn’t, you need to configure and set up the Fermi Science Tools.</p></li>
<li><p>ROOT: ROOT is not required by 3ML, but it provides the Minuit2 minimizer which can be used in 3ML. If you have ROOT, make sure that this works before running the script: <code class="docutils literal notranslate"><span class="pre">bash</span>&#160;&#160;&#160;&#160; <span class="pre">&gt;</span> <span class="pre">root-config</span> <span class="pre">--version</span>&#160;&#160;&#160;&#160; <span class="pre">5.34/36</span></code></p></li>
</ul>
</section>
<section id="Install-from-source-(advanced)">
<h2>Install from source (advanced)<a class="headerlink" href="#Install-from-source-(advanced)" title="Permalink to this heading"></a></h2>
<p>Remove any previous installation you might have with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>pip<span class="w"> </span>uninstall<span class="w"> </span>threeML
&gt;<span class="w"> </span>pip<span class="w"> </span>uninstall<span class="w"> </span>astromodels
&gt;<span class="w"> </span>pip<span class="w"> </span>uninstall<span class="w"> </span>cthreeML
</pre></div>
</div>
<p>then:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>scipy<span class="w"> </span>ipython<span class="w"> </span>astropy<span class="w"> </span>numba<span class="w"> </span>cython
&gt;<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/threeML/threeml.git
&gt;<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/threeML/astromodels.git<span class="w"> </span>--upgrade
</pre></div>
</div>
<p>In order to use the HAWC plugin, you will also need to install cthreeML (run this <em>after</em> setting up the HAWC environment):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/threeML/cthreeML.git
</pre></div>
</div>
<ul class="simple">
<li><p>NOTE: If you do not have permission to install packages in your current python environment, you can still install the packages by adding the <code class="docutils literal notranslate"><span class="pre">--user</span></code> option at the end of each <code class="docutils literal notranslate"><span class="pre">pip</span></code> command.</p></li>
</ul>
<section id="Tips-for-Mac-users">
<h3>Tips for Mac users<a class="headerlink" href="#Tips-for-Mac-users" title="Permalink to this heading"></a></h3>
<p>The following paths need to be added to you DYLD_LIBRARY path if you have FORTRAN installed via these package managers:</p>
<ul class="simple">
<li><p>Homebrew: <code class="docutils literal notranslate"><span class="pre">DYLD_LIBRARY_PATH=/usr/local/lib/gcc/&lt;version</span>&#160;&#160; <span class="pre">number&gt;:$DYLD_LIBRARY_PATH</span></code></p></li>
<li><p>Fink: <code class="docutils literal notranslate"><span class="pre">DYLD_LIBRARY_PATH=/sw/lib/gcc&lt;version</span>&#160;&#160; <span class="pre">number&gt;/lib:$DYLD_LIBRARY_PATH</span></code></p></li>
</ul>
<p>Please inform us if you have problems related to your FORTRAN distribution.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="3ML" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../intro.html" class="btn btn-neutral float-right" title="Intro" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017--2021, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>